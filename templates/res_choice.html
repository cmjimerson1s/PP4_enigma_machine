{% extends "base.html" %}
{% load res_tags %}
{% block content %}
{% for room in rooms %}
<h1>{{room}}</h1>
  {% for time in times %}
    <h3>{{time}}</h3>
    {% with bookings=queryset|res_date:today|res_room:room|res_time:time%}
      {% if bookings %}
        <button type="submit" disabled>Unavailable</button>
      {% else %}
      <form method="POST" action="{% url 'reservation_choice' %}">
        {% csrf_token %}
        <input type="hidden" name="picked_date" value="{{today}}">
        <input type="hidden" name="time" value="{{time}}">
        <input type="hidden" name="room" value="{{room}}">
        <button type="submit">Available</button>
      </form>
      {% endif %}
    {% endwith%}
  {% endfor %}
{% endfor %}

{% if cart %}
      <h2>Shopping Cart</h2>
      <ul>
          {% for item in cart %}
          <li>{{ item.key }}: {{ item.value }} ({{ item.specific_date }}) 
          <form method="POST">
              {% csrf_token %}
              <button type="submit" class="btn btn-danger" name="delete-item" value="{{ item.key }}|{{ item.value }}|{{ item.specific_date }}">Delete</button>
          </form>
          </li>        
          {% endfor %}
      </ul>
      <form method="POST">
          {% csrf_token %}
          <button type="submit" class="btn btn-danger" name="delete-all" value="true">Delete All Items</button>
      </form>
      <form form action="{% url 'booking_form'%}?cart={{ cart }}" method="post"> 
        {% csrf_token %}
        <input type="hidden" name="cart" value={{cart}}>
        <button type="submit">Continue to Booking</button>
    </form>

  {% endif %}

{% endblock %}